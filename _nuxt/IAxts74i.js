import{u as L}from"./C7jF4NAb.js";import{ad as N,j as d,r as y,k as g}from"./B4E7ZWnt.js";import{M as V}from"./B4q2DkeP.js";const O=()=>{const s=L(),{products:l,currentProduct:f,isLoading:P,error:p,totalItems:i,totalPages:h,currentPage:C,itemsPerPage:v}=N(s);return{products:l,currentProduct:f,isLoading:P,error:p,totalItems:i,totalPages:h,currentPage:C,itemsPerPage:v,getProductById:e=>s.getProductById(e),getProductName:e=>{const r=l.value.find(n=>n.id===e);return r?r.name:"Unknown Product"},getProductPrice:e=>{const r=l.value.find(n=>n.id===e);return r?r.sellingPrice:0},fetchProducts:async e=>await s.fetchProducts(e),fetchProductById:async e=>await s.fetchProductById(e),createProduct:async e=>await s.createProduct(e),updateProduct:async(e,r)=>await s.updateProduct(e,r),deleteProduct:async e=>await s.deleteProduct(e),resetStore:()=>{s.$reset()}}},u=new V,a=y([]),T=y(null),k=y([]),o=y(!1),c=y(null),R=()=>{const s=d(()=>a.value.filter(t=>t.isActive)),l=d(()=>a.value.filter(t=>!t.parentId&&t.isActive)),f=d(()=>a.value.length),P=d(()=>a.value.filter(t=>t.isActive).sort((t,e)=>e.totalValue-t.totalValue).slice(0,5)),p=d(()=>a.value.filter(t=>t.isActive).sort((t,e)=>e.productCount-t.productCount).slice(0,5)),i=t=>a.value.find(e=>e.id===t),h=t=>a.value.find(e=>e.name.toLowerCase()===t.toLowerCase()),C=t=>a.value.filter(e=>e.parentId===t&&e.isActive).sort((e,r)=>e.sortOrder-r.sortOrder),v=t=>{const e=[];let r=i(t);for(;r;)e.unshift(r),r=r.parentId?i(r.parentId):void 0;return e},m=t=>v(t).map(r=>r.name).join(" > "),w=async t=>{try{o.value=!0,c.value=null;const e=await u.getAll(t);return a.value=e.data,e}catch(e){throw c.value=e instanceof Error?e.message:"Failed to load categories",e}finally{o.value=!1}},I=async()=>{try{o.value=!0,c.value=null,k.value=await u.getCategoryTree()}catch(t){throw c.value=t instanceof Error?t.message:"Failed to load category tree",t}finally{o.value=!1}},B=async()=>{try{o.value=!0,c.value=null,T.value=await u.getStats()}catch(t){throw c.value=t instanceof Error?t.message:"Failed to load category stats",t}finally{o.value=!1}},S=async t=>{try{o.value=!0,c.value=null;const e=await u.create(t);return a.value.push(e),e}catch(e){throw c.value=e instanceof Error?e.message:"Failed to create category",e}finally{o.value=!1}},A=async(t,e)=>{try{o.value=!0,c.value=null;const r=await u.update(t,e);if(r){const n=a.value.findIndex(x=>x.id===t);n!==-1&&(a.value[n]=r)}return r}catch(r){throw c.value=r instanceof Error?r.message:"Failed to update category",r}finally{o.value=!1}},E=async t=>{try{o.value=!0,c.value=null;const e=await u.delete(t);return e&&(a.value=a.value.filter(r=>r.id!==t)),e}catch(e){throw c.value=e instanceof Error?e.message:"Failed to delete category",e}finally{o.value=!1}},F=async()=>{await w()};return{categories:g(a),categoryStats:g(T),categoryTree:g(k),loading:g(o),error:g(c),activeCategories:s,rootCategories:l,totalCategories:f,topCategoriesByValue:P,topCategoriesByProducts:p,getCategoryById:i,getCategoryByName:h,getSubCategories:C,getCategoryPath:v,getCategoryBreadcrumb:m,loadCategories:w,loadCategoryTree:I,loadCategoryStats:B,createCategory:S,updateCategory:A,deleteCategory:E,refreshCategories:F}};export{R as a,O as u};
