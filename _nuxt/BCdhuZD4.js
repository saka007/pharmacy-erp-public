import ce from"./B_BSdajj.js";import me from"./BiIHwpDv.js";import ve from"./Dv734B7a.js";import pe from"./M2-fOS9N.js";import fe from"./DgyfLFB-.js";import xe from"./BEk77WGX.js";import ge from"./C3XBHxYa.js";import be from"./CT9-M-Jt.js";import ye from"./DB-7dZs6.js";import Pe from"./BA7NvXv4.js";import{T as ke,a1 as we,r as v,j as A,f as Ce,c as f,a as t,b as a,w as r,o as c,t as n,X as R,W as x,O as Ve,Q as he,R as k,M as B,d as Ie,a4 as z}from"./C75sWQ17.js";import{u as _e,a as Se}from"./CcFabb5q.js";import{M as De}from"./Dv2xEQ-L.js";import{M as Ne}from"./qcfWgvxB.js";import{_ as Ue}from"./DlAUqK2U.js";import"./Bp30Rkwz.js";import"./C6o1UzvO.js";import"./a3IUqZJ6.js";import"./7s5qCgTI.js";import"./Du1f6vVH.js";import"./hZldab_6.js";import"./Kwvy9bwp.js";import"./D-dmaqJg.js";import"./DnWt4iB7.js";import"./GojKZ2PW.js";import"./DYFHDyQ0.js";import"./DLeBtkWy.js";import"./v7U6BRNz.js";import"./CmaQ8lbF.js";import"./B4q2DkeP.js";const Ae={class:"products-page"},Te={class:"grid"},Fe={class:"col-6 md:col-3"},je={class:"text-900 font-bold text-xl"},Ee={class:"col-6 md:col-3"},Me={class:"text-900 font-bold text-xl"},$e={class:"col-6 md:col-3"},Re={class:"text-900 font-bold text-xl"},Be={class:"col-6 md:col-3"},ze={class:"text-900 font-bold text-xl"},He={class:"col-12"},qe={class:"grid"},Le={class:"col-12 md:col-6"},Ke={class:"p-input-icon-left w-full"},Oe={class:"col-12 md:col-3"},We={class:"col-12 md:col-3"},Qe={class:"col-12"},Xe={class:"grid"},Ye={class:"product-image"},Ge=["src","alt"],Je={class:"product-badge"},Ze={class:"text-lg font-medium text-900"},et={class:"text-600"},tt={class:"flex flex-column gap-2"},lt={class:"flex justify-content-between align-items-center"},st={class:"font-bold text-900"},ot={class:"flex justify-content-between align-items-center"},at={class:"flex justify-content-between align-items-center"},it={class:"text-600"},nt={class:"flex gap-2"},rt={key:0,class:"text-center py-8"},ut={class:"flex items-center space-x-3"},dt={class:"text-lg font-semibold text-gray-900"},ct={class:"text-sm text-gray-600"},mt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},vt={key:0,class:"p-error"},pt={key:0,class:"p-error"},ft={key:0,class:"p-error"},xt={key:0,class:"p-error"},gt={class:"flex items-center"},bt={class:"font-medium"},yt={class:"text-sm text-gray-500"},Pt={key:0,class:"p-error"},kt={class:"flex items-center mt-1"},wt={class:"flex items-center justify-between w-full"},Ct={class:"font-medium"},Vt={class:"text-sm text-gray-500"},ht={key:0,class:"p-error"},It={class:"flex items-center mt-1"},_t={class:"col-span-2"},St={class:"col-span-2"},Dt={class:"flex items-center"},Nt={class:"flex justify-end space-x-2"},Ut={__name:"products",setup(At){const g=ke(),H=we(),{products:h,fetchProducts:q,createProduct:L,updateProduct:K,deleteProduct:O}=_e(),{categories:I,loadCategories:W}=Se(),Q=new De,X=new Ne,w=v(""),_=v(null),C=v(!1),b=v(null),N=v(!1),T=v([]),F=v([]);v([]);const o=v({name:"",sku:"",description:"",categoryId:null,barcode:"",purchasePrice:0,sellingPrice:0,taxRate:12,unit:"pieces",currentStock:0,reorderPoint:10,manufacturerId:null,hsnCodeId:null,isActive:!0}),i=v({name:"",sku:"",purchasePrice:"",sellingPrice:"",manufacturerId:"",hsnCodeId:""}),Y=v(["pieces","tablets","capsules","strips","bottles","boxes","sachets","vials","tubes","ml","grams"]),G=A(()=>F.value.map(l=>({...l,displayText:`${l.code} - ${l.description}`}))),S=A(()=>{var l,e,u,p,m,d;return{total:((l=h.value)==null?void 0:l.length)||0,categories:((e=I.value)==null?void 0:e.length)||0,featured:((p=(u=h.value)==null?void 0:u.filter(y=>y.isActive))==null?void 0:p.length)||0,newThisMonth:((d=(m=h.value)==null?void 0:m.filter(y=>{const P=new Date(y.createdAt),D=new Date,U=new Date(D.getFullYear(),D.getMonth(),1);return P>=U}))==null?void 0:d.length)||0}});Ce(async()=>{try{await Promise.all([q(),W(),te()])}catch(l){console.error("Failed to load products data:",l),g.add({severity:"error",summary:"Error",detail:"Failed to load products data",life:3e3})}});const j=A(()=>{let l=h.value||[];return w.value&&(l=l.filter(e=>e.name.toLowerCase().includes(w.value.toLowerCase())||e.sku.toLowerCase().includes(w.value.toLowerCase()))),_.value&&(l=l.filter(e=>{var u,p,m;return((u=e.category)==null?void 0:u.name)===((m=(p=I.value)==null?void 0:p.find(d=>d.id===_.value))==null?void 0:m.name)})),l}),J=l=>l<=10?"text-red-500 font-bold":l<=50?"text-yellow-500 font-medium":"text-green-500",Z=()=>{z("/inventory/manufacturers")},ee=()=>{z("/inventory/hsn-codes")},te=async()=>{try{const[l,e]=await Promise.all([Q.getActiveManufacturers(),X.getActiveHSNCodes()]);T.value=l,F.value=e}catch(l){console.error("Failed to load master data:",l),g.add({severity:"error",summary:"Error",detail:"Failed to load master data",life:3e3})}},le=()=>{b.value=null,M(),C.value=!0},E=l=>{b.value=l,ie(l),C.value=!0},se=l=>{E(l)},oe=l=>{H.require({message:`Are you sure you want to delete "${l.name}"? This action cannot be undone.`,header:"Delete Product",icon:"pi pi-exclamation-triangle",acceptClass:"p-button-danger",accept:()=>ae(l.id)})},ae=async l=>{try{await O(l),g.add({severity:"success",summary:"Success",detail:"Product deleted successfully",life:3e3})}catch(e){console.error("Failed to delete product:",e),g.add({severity:"error",summary:"Error",detail:"Failed to delete product",life:5e3})}},M=()=>{o.value={name:"",sku:"",description:"",categoryId:null,barcode:"",purchasePrice:0,sellingPrice:0,taxRate:12,unit:"pieces",currentStock:0,reorderPoint:10,manufacturerId:null,hsnCodeId:null,isActive:!0},i.value={name:"",sku:"",purchasePrice:"",sellingPrice:"",manufacturerId:"",hsnCodeId:""}},ie=l=>{o.value={name:l.name||"",sku:l.sku||"",description:l.description||"",categoryId:l.categoryId||null,barcode:l.barcode||"",purchasePrice:l.purchasePrice||0,sellingPrice:l.sellingPrice||0,taxRate:l.taxRate||12,unit:l.unit||"pieces",currentStock:l.currentStock||0,reorderPoint:l.reorderPoint||10,manufacturerId:l.manufacturerId||null,hsnCodeId:l.hsnCodeId||null,isActive:l.isActive!==!1},i.value={name:"",sku:"",purchasePrice:"",sellingPrice:"",manufacturerId:"",hsnCodeId:""}},ne=()=>{i.value={name:"",sku:"",purchasePrice:"",sellingPrice:"",manufacturerId:"",hsnCodeId:""};let l=!0;return o.value.name.trim()||(i.value.name="Product name is required",l=!1),o.value.sku.trim()||(i.value.sku="SKU is required",l=!1),(!o.value.purchasePrice||o.value.purchasePrice<=0)&&(i.value.purchasePrice="Purchase price must be greater than 0",l=!1),(!o.value.sellingPrice||o.value.sellingPrice<=0)&&(i.value.sellingPrice="Selling price must be greater than 0",l=!1),o.value.manufacturerId||(i.value.manufacturerId="Manufacturer is required",l=!1),o.value.hsnCodeId||(i.value.hsnCodeId="HSN Code is required",l=!1),l},re=async()=>{if(ne()){N.value=!0;try{const l={...o.value,expiryDate:o.value.expiryDate?o.value.expiryDate.toISOString().split("T")[0]:null};b.value?(await K(b.value.id,l),g.add({severity:"success",summary:"Success",detail:"Product updated successfully",life:3e3})):(await L(l),g.add({severity:"success",summary:"Success",detail:"Product created successfully",life:3e3})),$()}catch(l){console.error("Failed to save product:",l),g.add({severity:"error",summary:"Error",detail:l instanceof Error?l.message:"Failed to save product",life:5e3})}finally{N.value=!1}}},$=()=>{C.value=!1,b.value=null,M()};return(l,e)=>{const u=ce,p=me,m=ve,d=pe,y=fe,P=xe,D=ge,U=be,ue=ye,de=Pe;return c(),f("div",Ae,[e[51]||(e[51]=t("div",{class:"mb-4"},[t("h1",{class:"text-2xl font-bold text-900 m-0"},"Product Catalog"),t("p",{class:"text-600 mt-2 mb-0"},"Browse and manage your product catalog")],-1)),t("div",Te,[t("div",Fe,[a(u,{class:"text-center"},{content:r(()=>[e[17]||(e[17]=t("div",{class:"flex align-items-center justify-content-center mb-3"},[t("div",{class:"border-circle w-3rem h-3rem bg-blue-100 flex align-items-center justify-content-center"},[t("i",{class:"pi pi-shopping-cart text-blue-500 text-xl"})])],-1)),e[18]||(e[18]=t("div",{class:"text-500 font-medium mb-2"},"Total Products",-1)),t("div",je,n(S.value.total),1)]),_:1})]),t("div",Ee,[a(u,{class:"text-center"},{content:r(()=>[e[19]||(e[19]=t("div",{class:"flex align-items-center justify-content-center mb-3"},[t("div",{class:"border-circle w-3rem h-3rem bg-green-100 flex align-items-center justify-content-center"},[t("i",{class:"pi pi-tags text-green-500 text-xl"})])],-1)),e[20]||(e[20]=t("div",{class:"text-500 font-medium mb-2"},"Categories",-1)),t("div",Me,n(S.value.categories),1)]),_:1})]),t("div",$e,[a(u,{class:"text-center"},{content:r(()=>[e[21]||(e[21]=t("div",{class:"flex align-items-center justify-content-center mb-3"},[t("div",{class:"border-circle w-3rem h-3rem bg-purple-100 flex align-items-center justify-content-center"},[t("i",{class:"pi pi-star text-purple-500 text-xl"})])],-1)),e[22]||(e[22]=t("div",{class:"text-500 font-medium mb-2"},"Featured",-1)),t("div",Re,n(S.value.featured),1)]),_:1})]),t("div",Be,[a(u,{class:"text-center"},{content:r(()=>[e[23]||(e[23]=t("div",{class:"flex align-items-center justify-content-center mb-3"},[t("div",{class:"border-circle w-3rem h-3rem bg-orange-100 flex align-items-center justify-content-center"},[t("i",{class:"pi pi-clock text-orange-500 text-xl"})])],-1)),e[24]||(e[24]=t("div",{class:"text-500 font-medium mb-2"},"New This Month",-1)),t("div",ze,n(S.value.newThisMonth),1)]),_:1})]),t("div",He,[a(u,null,{content:r(()=>[t("div",qe,[t("div",Le,[t("span",Ke,[e[25]||(e[25]=t("i",{class:"pi pi-search"},null,-1)),a(p,{modelValue:w.value,"onUpdate:modelValue":e[0]||(e[0]=s=>w.value=s),placeholder:"Search products...",class:"w-full"},null,8,["modelValue"])])]),t("div",Oe,[a(m,{modelValue:_.value,"onUpdate:modelValue":e[1]||(e[1]=s=>_.value=s),options:R(I),"option-label":"name","option-value":"id",placeholder:"All Categories",class:"w-full"},null,8,["modelValue","options"])]),t("div",We,[a(d,{label:"Add Product",icon:"pi pi-plus",class:"w-full",onClick:le})])])]),_:1})]),t("div",Qe,[a(u,null,{title:r(()=>e[26]||(e[26]=[Ie("Product Catalog")])),content:r(()=>[t("div",Xe,[(c(!0),f(Ve,null,he(j.value,s=>(c(),f("div",{key:s.id,class:"col-12 md:col-6 lg:col-4"},[a(u,{class:"product-card h-full"},{header:r(()=>[t("div",Ye,[t("img",{src:s.image||"/images/product-placeholder.png",alt:s.name,class:"w-full h-8rem object-cover"},null,8,Ge),t("div",Je,[s.isNew?(c(),B(y,{key:0,value:"NEW",severity:"success",class:"absolute top-0 right-0 m-2"})):x("",!0),s.isFeatured?(c(),B(y,{key:1,value:"FEATURED",severity:"warning",class:"absolute top-0 left-0 m-2"})):x("",!0)])])]),title:r(()=>[t("div",Ze,n(s.name),1)]),subtitle:r(()=>{var V;return[t("div",et,n(((V=s.category)==null?void 0:V.name)||"No Category"),1)]}),content:r(()=>[t("div",tt,[t("div",lt,[e[27]||(e[27]=t("span",{class:"text-500"},"Price:",-1)),t("span",st,"â‚¹"+n(s.sellingPrice||0),1)]),t("div",ot,[e[28]||(e[28]=t("span",{class:"text-500"},"Stock:",-1)),t("span",{class:k(J(s.currentStock||0))},n(s.currentStock||0)+" "+n(s.unit||"units"),3)]),t("div",at,[e[29]||(e[29]=t("span",{class:"text-500"},"SKU:",-1)),t("span",it,n(s.sku),1)])])]),footer:r(()=>[t("div",nt,[a(d,{label:"View",icon:"pi pi-eye",size:"small",outlined:"",class:"flex-1",onClick:V=>se(s)},null,8,["onClick"]),a(d,{label:"Edit",icon:"pi pi-pencil",size:"small",class:"flex-1",onClick:V=>E(s)},null,8,["onClick"]),a(d,{label:"Delete",icon:"pi pi-trash",size:"small",severity:"danger",outlined:"",class:"flex-1",onClick:V=>oe(s)},null,8,["onClick"])])]),_:2},1024)]))),128))]),j.value.length===0?(c(),f("div",rt,e[30]||(e[30]=[t("i",{class:"pi pi-inbox text-4xl text-300 mb-3"},null,-1),t("div",{class:"text-900 font-medium mb-2"},"No products found",-1),t("div",{class:"text-600"},"Try adjusting your search or filters",-1)]))):x("",!0)]),_:1})])]),a(ue,{visible:C.value,"onUpdate:visible":e[16]||(e[16]=s=>C.value=s),modal:!0,closable:!0,style:{width:"800px"},class:"p-dialog-maximized-responsive"},{header:r(()=>[t("div",ut,[e[31]||(e[31]=t("div",{class:"bg-blue-600 p-2 rounded-lg"},[t("i",{class:"pi pi-shopping-cart text-white"})],-1)),t("div",null,[t("h3",dt,n(b.value?"Edit Product":"Add New Product"),1),t("p",ct,n(b.value?"Update product information":"Create a new product"),1)])])]),footer:r(()=>[t("div",Nt,[a(d,{label:"Cancel",icon:"pi pi-times",class:"p-button-text",onClick:$}),a(d,{label:"Save",icon:"pi pi-check",class:"p-button-primary",loading:N.value,onClick:re},null,8,["loading"])])]),default:r(()=>[t("div",mt,[e[48]||(e[48]=t("div",{class:"col-span-2"},[t("h4",{class:"text-md font-medium text-gray-900 mb-4"},"Basic Information")],-1)),t("div",null,[e[32]||(e[32]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Product Name *",-1)),a(p,{modelValue:o.value.name,"onUpdate:modelValue":e[2]||(e[2]=s=>o.value.name=s),placeholder:"Enter product name",class:k(["w-full",{"p-invalid":i.value.name}])},null,8,["modelValue","class"]),i.value.name?(c(),f("small",vt,n(i.value.name),1)):x("",!0)]),t("div",null,[e[33]||(e[33]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"SKU *",-1)),a(p,{modelValue:o.value.sku,"onUpdate:modelValue":e[3]||(e[3]=s=>o.value.sku=s),placeholder:"Enter SKU",class:k(["w-full",{"p-invalid":i.value.sku}])},null,8,["modelValue","class"]),i.value.sku?(c(),f("small",pt,n(i.value.sku),1)):x("",!0)]),t("div",null,[e[34]||(e[34]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Category",-1)),a(m,{modelValue:o.value.categoryId,"onUpdate:modelValue":e[4]||(e[4]=s=>o.value.categoryId=s),options:R(I),"option-label":"name","option-value":"id",placeholder:"Select category",class:"w-full"},null,8,["modelValue","options"])]),t("div",null,[e[35]||(e[35]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Barcode",-1)),a(p,{modelValue:o.value.barcode,"onUpdate:modelValue":e[5]||(e[5]=s=>o.value.barcode=s),placeholder:"Enter barcode",class:"w-full"},null,8,["modelValue"])]),e[49]||(e[49]=t("div",{class:"col-span-2"},[t("h4",{class:"text-md font-medium text-gray-900 mb-4 mt-4"},"Pricing Information")],-1)),t("div",null,[e[36]||(e[36]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Purchase Price *",-1)),a(P,{modelValue:o.value.purchasePrice,"onUpdate:modelValue":e[6]||(e[6]=s=>o.value.purchasePrice=s),mode:"currency",currency:"INR",locale:"en-IN",class:k(["w-full",{"p-invalid":i.value.purchasePrice}])},null,8,["modelValue","class"]),i.value.purchasePrice?(c(),f("small",ft,n(i.value.purchasePrice),1)):x("",!0)]),t("div",null,[e[37]||(e[37]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Selling Price *",-1)),a(P,{modelValue:o.value.sellingPrice,"onUpdate:modelValue":e[7]||(e[7]=s=>o.value.sellingPrice=s),mode:"currency",currency:"INR",locale:"en-IN",class:k(["w-full",{"p-invalid":i.value.sellingPrice}])},null,8,["modelValue","class"]),i.value.sellingPrice?(c(),f("small",xt,n(i.value.sellingPrice),1)):x("",!0)]),t("div",null,[e[38]||(e[38]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Tax Rate (%)",-1)),a(P,{modelValue:o.value.taxRate,"onUpdate:modelValue":e[8]||(e[8]=s=>o.value.taxRate=s),suffix:"%",min:0,max:100,class:"w-full"},null,8,["modelValue"])]),t("div",null,[e[39]||(e[39]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Unit",-1)),a(m,{modelValue:o.value.unit,"onUpdate:modelValue":e[9]||(e[9]=s=>o.value.unit=s),options:Y.value,placeholder:"Select unit",class:"w-full"},null,8,["modelValue","options"])]),e[50]||(e[50]=t("div",{class:"col-span-2"},[t("h4",{class:"text-md font-medium text-gray-900 mb-4 mt-4"},"Stock Information")],-1)),t("div",null,[e[40]||(e[40]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Current Stock",-1)),a(P,{modelValue:o.value.currentStock,"onUpdate:modelValue":e[10]||(e[10]=s=>o.value.currentStock=s),min:0,class:"w-full"},null,8,["modelValue"])]),t("div",null,[e[41]||(e[41]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Reorder Point",-1)),a(P,{modelValue:o.value.reorderPoint,"onUpdate:modelValue":e[11]||(e[11]=s=>o.value.reorderPoint=s),min:0,class:"w-full"},null,8,["modelValue"])]),t("div",null,[e[43]||(e[43]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Manufacturer *",-1)),a(m,{modelValue:o.value.manufacturerId,"onUpdate:modelValue":e[12]||(e[12]=s=>o.value.manufacturerId=s),options:T.value,"option-label":"name","option-value":"id",placeholder:"Select manufacturer",class:k(["w-full",{"p-invalid":i.value.manufacturerId}]),filter:""},{option:r(({option:s})=>[t("div",gt,[t("div",null,[t("div",bt,n(s.name),1),t("div",yt,n(s.code),1)])])]),_:1},8,["modelValue","options","class"]),i.value.manufacturerId?(c(),f("small",Pt,n(i.value.manufacturerId),1)):x("",!0),t("div",kt,[e[42]||(e[42]=t("small",{class:"text-gray-500"},"Don't see your manufacturer?",-1)),a(d,{label:"Add New",icon:"pi pi-plus",size:"small",text:"",class:"ml-2 p-0 text-xs",onClick:Z})])]),t("div",null,[e[45]||(e[45]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"HSN Code *",-1)),a(m,{modelValue:o.value.hsnCodeId,"onUpdate:modelValue":e[13]||(e[13]=s=>o.value.hsnCodeId=s),options:G.value,"option-label":"displayText","option-value":"id",placeholder:"Select HSN code",class:k(["w-full",{"p-invalid":i.value.hsnCodeId}]),filter:""},{option:r(({option:s})=>[t("div",wt,[t("div",null,[t("div",Ct,n(s.code),1),t("div",Vt,n(s.description),1)]),a(y,{value:`${s.taxRate}%`,severity:"info",class:"ml-2"},null,8,["value"])])]),_:1},8,["modelValue","options","class"]),i.value.hsnCodeId?(c(),f("small",ht,n(i.value.hsnCodeId),1)):x("",!0),t("div",It,[e[44]||(e[44]=t("small",{class:"text-gray-500"},"Don't see your HSN code?",-1)),a(d,{label:"Add New",icon:"pi pi-plus",size:"small",text:"",class:"ml-2 p-0 text-xs",onClick:ee})])]),t("div",_t,[e[46]||(e[46]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Description",-1)),a(D,{modelValue:o.value.description,"onUpdate:modelValue":e[14]||(e[14]=s=>o.value.description=s),placeholder:"Enter product description",class:"w-full",rows:"3"},null,8,["modelValue"])]),t("div",St,[t("div",Dt,[a(U,{modelValue:o.value.isActive,"onUpdate:modelValue":e[15]||(e[15]=s=>o.value.isActive=s),"input-id":"isActive",binary:""},null,8,["modelValue"]),e[47]||(e[47]=t("label",{for:"isActive",class:"ml-2 text-sm font-medium text-gray-700"}," Active Product ",-1))])])])]),_:1},8,["visible"]),a(de)])}}},ul=Ue(Ut,[["__scopeId","data-v-23efc9db"]]);export{ul as default};
