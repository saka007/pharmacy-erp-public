import{af as h,Z as g,a4 as r}from"./B4E7ZWnt.js";import{u as f}from"./g1gehacp.js";const v=["/login","/forgot-password","/reset-password","/_nuxt/"],y={"/dashboard":{permissions:["report:sales"]},"/inventory":{permissions:["inventory:read"],roles:["admin","inventory_manager","pharmacist"]},"/inventory/manage":{permissions:["inventory:create","inventory:update","inventory:delete"],roles:["admin","inventory_manager"]},"/sales":{permissions:["sale:read"],roles:["admin","pharmacist","cashier","sales_rep"]},"/purchases":{permissions:["purchase:read"],roles:["admin","inventory_manager"]},"/reports":{permissions:["report:sales","report:inventory","report:financial"],roles:["admin","inventory_manager"]},"/settings":{permissions:["settings:general"],roles:["admin"]},"/users":{permissions:["user:read"],roles:["admin"]}},w=h(t=>{var m,u;const i=g(),o=t.path;if(v.some(e=>o.startsWith(e)))return;if(!i.isAuthenticated)return r("/login");const a=Object.entries(y).sort(([e],[s])=>s.length-e.length).find(([e])=>o.startsWith(e));if(a){const[e,{permissions:s=[],roles:l=[]}]=a,n=i.user;if(!n)return r("/login");if(l.length>0&&!l.includes((m=n.role)==null?void 0:m.name))return r("/unauthorized");if(s.length>0&&!s.some(p=>{var d;return(d=n.permissions)==null?void 0:d.some(c=>c.code===p)}))return r("/unauthorized")}(u=t.meta)!=null&&u.title&&f({title:t.meta.title})});export{w as default};
